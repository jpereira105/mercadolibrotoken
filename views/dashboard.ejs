<!DOCTYPE html>
<html>
<head>
  <title>Dashboard de Monitoreo</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 20px; }
    .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px #ccc; margin-bottom: 20px; }
    .ok { color: green; }
    .warn { color: orange; }
    .error { color: red; }
    button { padding: 10px 20px; margin-right: 10px; }
  </style>
</head>
<body>
  <h2>ğŸ“Š Dashboard Operativo</h2>

  <div class="card">
    <h3>ğŸ” Token</h3>
    <% if (token) { %>
      <p class="ok">âœ… Token activo</p>
      <p><strong>Access Token:</strong> <%= token.access_token %></p>
      <p><strong>Expira en:</strong> <%= token.expires_in %> segundos</p>
      <% if (token.expires_in < 300) { %>
        <p class="warn">âš ï¸ El token estÃ¡ por expirar</p>
      <% } %>
    <% } else { %>
      <p class="error">âŒ Token no disponible</p>
    <% } %>
    <form action="/refresh" method="get">
      <button type="submit">ğŸ”„ Refrescar Token</button>
    </form>
    <form action="/ver-permisos" method="get">
      <button type="submit">ğŸ‘ï¸ Ver Permisos</button>
    </form>
  </div>

  <div class="card">
    <h3>ğŸ“¦ Scraping</h3>
    <p><strong>Ãšltima ejecuciÃ³n:</strong> <%= scraping.lastRun %></p>
    <p><strong>Items extraÃ­dos:</strong> <%= scraping.items %></p>
    <p><strong>Errores:</strong> <%= scraping.errors %></p>
  </div>

  <div class="card">
    <h3>ğŸ§  Estado del Sistema</h3>
    <p><strong>Modo:</strong> <%= system.mode %></p>
    <p><strong>AutonomÃ­a:</strong> <%= system.autonomy ? 'ğŸŸ¢ Activa' : 'ğŸ”´ Manual' %></p>
  </div>
</body>
</html>

